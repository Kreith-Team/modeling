<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <style>
      #graph {
        width: 100%;
        height: 900px;
      }
    </style>
    <base target="_top">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/cytoscape/3.18.0/cytoscape.min.js" integrity="sha512-bg1QBgIk64XNmh8qAaxY2W6TKZ4/Q2sbPQLJ+1vhT3BD+DXXzAqhIbWdgeM82XWcbJKblEoSNhXiakf1NlWU3g==" crossorigin="anonymous"></script>

    <script src="https://unpkg.com/layout-base/layout-base.js"></script>

    <script src="https://unpkg.com/cose-base/cose-base.js"></script>
    <script src="https://unpkg.com/cytoscape-fcose/cytoscape-fcose.js"></script>

    <script src="https://unpkg.com/klayjs/klay.js"></script>
    <script src="https://unpkg.com/cytoscape-klay/cytoscape-klay.js"></script>
  </head>
  <body>
    <? if (!web) { // check if in sidebar mode ?>
      <?!= "<a href = \"" + buildUrl(ssid) + "\" target=\"_blank\">Open window</a>" ?>
    <? } ?>
    <p>Active User: <?= activeUser ?></p>
    <p>Effective User: <?= effectiveUser ?></p>
    <h1>Modeling App Loaded</h1>
    <div id="graph"></div>
    
    <script>
      data = <?!= JSON.stringify(getUIData(SpreadsheetApp.openById(ssid).getSheets()[0])) ?>
    </script>
    <?!= include('Graph.js'); ?>
  </body>
</html>

