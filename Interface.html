<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <base target="_top">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  </head>
  <body>
    <? if (!web) { // check if in sidebar mode ?>
      <?!= "<a href = \"" + buildUrl(ssid) + "\" target=\"_blank\">Open window</a>" ?>
    <? } ?>
    <p>Active User: <?= activeUser ?></p>
    <p>Effective User: <?= effectiveUser ?></p>
    <h1>Modeling App Loaded</h1>
    <div id=""></div>
    <?
      Logger.log(ssid);
      let spreadsheet = SpreadsheetApp.openById(ssid);
      let sheet = spreadsheet.getSheets()[0];
      let relations = findRecurrence(sheet);
      for (let i = 0; i < relations.length; i++) {
      ?>
        <div><?!= "<a onmouseover=\"google.script.run.withSuccessHandler( () => { console.log('Success'); } ).withFailureHandler( () => { console.log('Failure.') }).highlight('" + ssid + "', '" + relations[i].range.getA1Notation() + "')\""
        + "onmouseout=\"google.script.run.withSuccessHandler( () => { console.log('Success'); } ).withFailureHandler( () => { console.log('Failure.') }).unhighlight('" + ssid + "', '" + relations[i].range.getA1Notation() + "')\""
        + ">" 
        ?> 
        <?= relations[i].formula ?> <?!= "</a>" ?> <?= relations[i].range.getA1Notation() ?></div>
      <?
      }
    ?>
    
    
    <button
      onclick="google.script.run.withSuccessHandler( () => { console.log('Success'); } ).withFailureHandler( () => { console.log('Failure.') }).test()" >
      Test
    </button>
    
    
    <script>
      "use strict";
      console.log("beginning");
      
      $( function() {
        let relations = <?= getData(ssid); ?>;
        console.log(relations);
        google.script.run.test();
      });
      console.log("here");
      
      function 
      
    
      function readSuccess(value) {
        console.log("Read successful w value ", value);
      }
      function readFailure(err) {
        console.log("Read failed w error ", JSON.stringify(err));
      }
    </script>
  </body>
</html>

